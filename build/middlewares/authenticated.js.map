{"version":3,"sources":["../../src/middlewares/authenticated.js"],"names":["jwt","config","authenticated","request","response","next","token","headers","authorization","verify","JWT_SECRET","error","_","json","verifyToken","decoded"],"mappings":"AAAA,OAAOA,GAAP,MAAgB,cAAhB;AACA,SAASC,MAAT,QAAuB,cAAvB;;AAEA,MAAMC,aAAa,GAAG,CAACC,OAAD,EAAUC,QAAV,EAAoBC,IAApB,KAA6B;AAC/C,QAAMC,KAAK,GAAGH,OAAO,CAACI,OAAR,CAAgBC,aAA9B;AACAR,EAAAA,GAAG,CAACS,MAAJ,CAAWH,KAAX,EAAkBL,MAAM,CAACS,UAAzB,EAAqC,CAACC,KAAD,EAAQC,CAAR,KAAc;AAC/C,QAAID,KAAJ,EAAW;AACPP,MAAAA,QAAQ,CAACS,IAAT,CAAc,oBAAd;AACH,KAFD,MAEO;AACHR,MAAAA,IAAI;AACP;AACJ,GAND;AAOH,CATD;;AAWA,OAAO,MAAMS,WAAW,GAAGR,KAAK,IAAI;AAChC,MAAI;AACA,UAAMS,OAAO,GAAGf,GAAG,CAACS,MAAJ,CAAWH,KAAX,EAAkBL,MAAM,CAACS,UAAzB,CAAhB;AACA,WAAOK,OAAP;AACH,GAHD,CAGE,MAAM;AACJ,WAAO,KAAP;AACH;AACJ,CAPM;AASP,eAAeb,aAAf","sourcesContent":["import jwt from 'jsonwebtoken';\r\nimport { config } from '../config.js';\r\n\r\nconst authenticated = (request, response, next) => {\r\n    const token = request.headers.authorization;\r\n    jwt.verify(token, config.JWT_SECRET, (error, _) => {\r\n        if (error) {\r\n            response.json('Token not provided');\r\n        } else {\r\n            next();\r\n        }\r\n    });\r\n};\r\n\r\nexport const verifyToken = token => {\r\n    try {\r\n        const decoded = jwt.verify(token, config.JWT_SECRET);\r\n        return decoded;\r\n    } catch {\r\n        return false;\r\n    }\r\n};\r\n\r\nexport default authenticated;"],"file":"authenticated.js"}